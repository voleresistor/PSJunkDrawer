function Purge-CyberArk {
    [CmdletBinding]
    param (

    )

    $removeKeys = @(
        'hklm:\SOFTWARE\Classes\*\shellex\PropertySheetHandlers\{AA5B461C-6663-41F8-BDD4-67A7A09B2F3D}',
        'hklm:\SOFTWARE\Classes\CLSID\{09B6EED7-2B3C-43B2-AD9E-D4BDF10CA4E5}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}',
        'hklm:\SOFTWARE\Classes\CLSID\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{36A51607-1BC1-4C2E-BBB4-1CD9097A177C}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{48F33471-DF24-48AF-BD75-0BF25C1D6FFE}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{AA5B461C-6663-41F8-BDD4-67A7A09B2F3D}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{AC887FCC-4DE9-419D-AE17-6460A5CC501F}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{CA7D49C4-9EE1-4DC3-A7E1-C2CF9A59237B}',
        'hklm:\SOFTWARE\Classes\CLSID\{CA7D49C4-9EE1-4DC3-A7E1-C2CF9A59237B}\DefaultIcon',
        'hklm:\SOFTWARE\Classes\CLSID\{CA7D49C4-9EE1-4DC3-A7E1-C2CF9A59237B}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{E0F148CD-0165-4BE4-A50B-8DB45078A177}\InprocServer32',
        'hklm:\SOFTWARE\Classes\CLSID\{EA0A40FA-9EC5-4862-A283-B3A3C84B908C}\InprocServer32',
        'hklm:\SOFTWARE\Classes\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\0\win64',
        'hklm:\SOFTWARE\Classes\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\TypeLib\{1F38C6CA-6D6C-4E3D-9C43-39D8BE41EE47}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\TypeLib\{4344A3D4-0DE5-4E80-88E6-6F3FAFE76A15}\1.0\0\win64',
        'hklm:\SOFTWARE\Classes\TypeLib\{4344A3D4-0DE5-4E80-88E6-6F3FAFE76A15}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\TypeLib\{8823DF52-5CDD-45DC-BE7D-A5E51C0716CE}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\TypeLib\{8823DF52-5CDD-45DC-BE7D-A5E51C0716CE}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\TypeLib\{B4C51199-A31A-42D7-ADEA-E7B23EB97CA4}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\TypeLib\{B4C51199-A31A-42D7-ADEA-E7B23EB97CA4}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\TypeLib\{E034BEA2-0D47-4A95-A485-0EF6C0245353}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\TypeLib\{E034BEA2-0D47-4A95-A485-0EF6C0245353}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\TypeLib\{E4246421-5048-44EC-A232-C1F4695EF2EB}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\TypeLib\{E4246421-5048-44EC-A232-C1F4695EF2EB}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\0\win64',
        'hklm:\SOFTWARE\Classes\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\Viewfinity.VfBho32',
        'hklm:\SOFTWARE\Classes\Viewfinity.VfBho32.1',
        'hklm:\SOFTWARE\Classes\Viewfinity.VfBho64',
        'hklm:\SOFTWARE\Classes\Viewfinity.VfBho64.1',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{09B6EED7-2B3C-43B2-AD9E-D4BDF10CA4E5}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{A3CD4BF9-EC17-47A4-833C-50A324D6FF35}\ToolboxBitmap32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{AA5B461C-6663-41F8-BDD4-67A7A09B2F3D}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{AC887FCC-4DE9-419D-AE17-6460A5CC501F}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{CA7D49C4-9EE1-4DC3-A7E1-C2CF9A59237B}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{DD803EC9-0C42-449E-BA14-D6D68803B9CD}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{E0F148CD-0165-4BE4-A50B-8DB45078A177}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{EA0A40FA-9EC5-4862-A283-B3A3C84B908C}\InprocServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\CLSID\{FFD9EBBE-866E-4f82-9FAB-4C93876E4430}\LocalServer32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\0\win64',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{1F38C6CA-6D6C-4E3D-9C43-39D8BE41EE47}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{4344A3D4-0DE5-4E80-88E6-6F3FAFE76A15}\1.0\0\win64',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{4344A3D4-0DE5-4E80-88E6-6F3FAFE76A15}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{8823DF52-5CDD-45DC-BE7D-A5E51C0716CE}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{8823DF52-5CDD-45DC-BE7D-A5E51C0716CE}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{B4C51199-A31A-42D7-ADEA-E7B23EB97CA4}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{B4C51199-A31A-42D7-ADEA-E7B23EB97CA4}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{E034BEA2-0D47-4A95-A485-0EF6C0245353}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{E034BEA2-0D47-4A95-A485-0EF6C0245353}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{E4246421-5048-44EC-A232-C1F4695EF2EB}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{E4246421-5048-44EC-A232-C1F4695EF2EB}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\0\win32',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\0\win64',
        'hklm:\SOFTWARE\Classes\WOW6432Node\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\HELPDIR',
        'hklm:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}',
        'hklm:\SOFTWARE\Puffer\ApplicationInstallation\CyberArk_EndpointPrivilegeManagerAgent_11.7.1.359_EN_01',
        'hklm:\SOFTWARE\Puffer\ApplicationInstallation\CyberArk_EndpointPrivilegeManager_21.8.0.636_x64_EN_01',
        'hklm:\SOFTWARE\Puffer\ApplicationInstallation\CyberArk_EndpointPrivilegeManager_22.2.0.795_x64_EN_01',
        'hklm:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{09B6EED7-2B3C-43B2-AD9E-D4BDF10CA4E5}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{1A87C84E-8C85-4E23-966D-081EF2EE16EE}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{A3CD4BF9-EC17-47A4-833C-50A324D6FF35}\ToolboxBitmap32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{AA5B461C-6663-41F8-BDD4-67A7A09B2F3D}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{AC887FCC-4DE9-419D-AE17-6460A5CC501F}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{CA7D49C4-9EE1-4DC3-A7E1-C2CF9A59237B}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{DD803EC9-0C42-449E-BA14-D6D68803B9CD}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{E0F148CD-0165-4BE4-A50B-8DB45078A177}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{EA0A40FA-9EC5-4862-A283-B3A3C84B908C}\InprocServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\CLSID\{FFD9EBBE-866E-4f82-9FAB-4C93876E4430}\LocalServer32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\0\win32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\0\win64',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{1B9BC579-7132-46CD-8975-4B02D07CE4E7}\1.0\HELPDIR',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{1F38C6CA-6D6C-4E3D-9C43-39D8BE41EE47}\1.0\0\win32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{4344A3D4-0DE5-4E80-88E6-6F3FAFE76A15}\1.0\0\win64',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{4344A3D4-0DE5-4E80-88E6-6F3FAFE76A15}\1.0\HELPDIR',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{8823DF52-5CDD-45DC-BE7D-A5E51C0716CE}\1.0\0\win32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{8823DF52-5CDD-45DC-BE7D-A5E51C0716CE}\1.0\HELPDIR',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{B4C51199-A31A-42D7-ADEA-E7B23EB97CA4}\1.0\0\win32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{B4C51199-A31A-42D7-ADEA-E7B23EB97CA4}\1.0\HELPDIR',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{E034BEA2-0D47-4A95-A485-0EF6C0245353}\1.0\0\win32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{E034BEA2-0D47-4A95-A485-0EF6C0245353}\1.0\HELPDIR',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{E4246421-5048-44EC-A232-C1F4695EF2EB}\1.0\0\win32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{E4246421-5048-44EC-A232-C1F4695EF2EB}\1.0\HELPDIR',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\0\win32',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\0\win64',
        'hklm:\SOFTWARE\WOW6432Node\Classes\TypeLib\{F3AB00D5-DF59-4D2E-B2C7-1E353B48FE7E}\1.0\HELPDIR'
    )

    $removeVals = @{
        
    }

    foreach ($k in $removeKeys) {
        if (Test-Path -Path $k -ErrorAction SilentlyContinue) {
            Write-Verbose "Removing $k"
            Remove-Item -Path $k -Recurse -Force -WhatIf
        }
    }
}